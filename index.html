<head>
  <script src="assets/js/dist/app.js"></script>
</head>
<body>
  <div id="app"></div>
  <script>
    const app = Elm.Main.init({
      node: document.querySelector('#app'),
    });
    app.ports.createCredential.subscribe(async publicKey => {
      publicKey.challenge = Uint8Array.from(publicKey.challenge);  // FIXME: do this in elm world.
      publicKey.user.id = Uint8Array.from(publicKey.user.id);
      publicKey.pubKeyCredParams.forEach(v => {
        v.type = v.type_;
        delete v.type_;
      });
      publicKey.attestation = 'none';
      publicKey.authenticatorSelection = {
        requireResidentKey: false,
        userVerification: 'discouraged',
      };
      console.log(publicKey);
      const result = await navigator.credentials.create({ publicKey });
      console.log(result);
    });
  </script>
</body>
